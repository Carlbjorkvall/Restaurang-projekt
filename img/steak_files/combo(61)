YUI.add("hermes-lang-photo-card",function(e,o){e.Intl.add("hermes/photo-card","en-US",{SHARE_THIS_PHOTO:["Share this photo"],SEND_A_MESSAGE:["Send a message"],FOLLOW_USER:['Follow <span class="username-text">',"${username}","</span>"],UNFOLLOW_USER:['Unfollow <span class="username-text">',"${username}","</span>"],BLOCK_USER:['Block <span class="username-text">',"${username}","</span>"],UNBLOCK_USER:['Unblock <span class="username-text">',"${username}","</span>"],SHARE_PHOTOSTREAM:["Share photostream"],SHARE_GROUP:["Share group"],JOIN_GROUP:["Join group"],LEAVE_GROUP:["Leave group"],BLOCK_USER_QUESTION:['Block <span class="username-text">',"${username}","</span>?"],BLOCK_CONFIRM_MESSAGE:["They will not be able to follow you, interact with your photos or videos, or send you FlickrMail. Any comments or faves on your content from them will be deleted, and your content will be removed from their galleries."],BLOCK_CONFIRM_MESSAGE_NOTE:["Note: While the block itself will occur immediately, <b>removal of comments and favorites can take up to several hours</b> (though hopefully not that long!)."],HIDE_FROM_ACTIVITY_FEED:["Hide from activity feed"],SHOW_IN_ACTIVITY_FEED:["Show in activity feed"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-header",function(o,e){o.Intl.add("hermes/header","en-US",{EDIT_COVER_PHOTO:["Edit cover photo"],PHOTOSTREAM:["Photostream"],ALBUMS:["Albums"],FAVORITES:["Favorites"],CREATIONS:["Creations"],PHOTO_BOOKS:["Photo Books"],EDIT:["Edit"],PUBLIC:["Public"],ALL:["All"],CHANGE_YOUR_BUDDY_ICON:["Change your Buddy Icon"],CHANGE_YOUR_GROUP_ICON:["Change your group icon"],MEMBER_SINCE:["Member Since"],GROUP_SINCE:["Group Since"],MDY_DATE:[{type:"date",valueName:"mdyDate",format:"medium"}],PHOTOS:["Photos"],VIEWS:["Views"],VIEW_ALL_ALBUMS:["View all albums"],SEND_FLICKR_MAIL:["Send FlickrMail"],BLOCK:["Block"],USERS_GOD_PAGE:["User's God Page"],GROUP_GOD_PAGE:["God"],ADMINISTRATION:["Administration"],DISCUSSIONS:["Discussions"],MEMBERS:["Members"],MAP:["Map"],ABOUT:["About"],INVITE:["Invite Friends"],OVERVIEW:["Overview"],FULLSCREEN:["Fullscreen"],SHARE_THIS_PAGE:["Share this page"],COMMENT:["Comment"],MORE_ACTIONS:["More actions"],THUMBNAIL_VIEW:["Thumbnail view"],GROUP_LIST:["Group List"],CREATE_GROUP:["Create Group"],COVER_PHOTO_CHOOSE:["Choose Cover Photo"],COVER_PHOTO_UPLOAD:["Upload a photo"],COVER_PHOTO_SET_POSITION:["Drag to set position!"],COVER_PHOTO_SAVE:["Save"],COVER_PHOTO_CANCEL:["Cancel"],COVER_PHOTO_LIST_ERROR:["We're having some trouble listing your photos. Try again in a few seconds."],COVER_PHOTO_SELECT_ERROR:["We're having some trouble selecting that photo. Try again in a few seconds."],COVER_PHOTO_POSITION_ERROR:["We're having some trouble positioning that photo. Try again in a few seconds."],COVER_PHOTO_LOW_RESOLUTION:["This photo is small and may not look great as a coverphoto."],COVER_PHOTO_NO_PHOTOS:["Uh oh! No photos here.<br/>What? Do we have to take them for you, too?"],GROUPS_HEADER:["Your Groups"],GROUP_JOIN:["Join Group"],GROUP_JOINED:["Joined"],GROUP_JOIN_REQUESTED:["Join Requested"],GROUP_LEAVE_GROUP:["Leave Group"],GROUPS_OPT_OUT_MESSAGE:["You are viewing the beta version of our new groups experience. Click here to return to the old version."],GROUPS_OPT_IN_MESSAGE:["Go back to the beta groups experience."],STEAMPUNK_OCTOPUS:["Steampunk Octopus"],FOLLOWERS:[{type:"plural",valueName:"count",options:{one:"${#} Follower",other:"${#} Followers"}}],FOLLOWING:[{type:"plural",valueName:"count",options:{one:"${#} Following",other:"${#} Following"}}],FOLLOWER_COUNT:[{type:"plural",valueName:"count",options:{one:["${countString}"," Follower"],other:["${countString}"," Followers"]}}],FOLLOWING_COUNT:[{type:"plural",valueName:"count",options:{one:["${countString}"," Following"],other:["${countString}"," Following"]}}],FOLLOWERS_SIMPLE:["Followers"],FOLLOWING_SIMPLE:["Following"],JOINED_YEAR:["Joined ","${year}"],COUNT_PHOTOS:[{type:"plural",valueName:"count",options:{one:"${#} Photo",other:"${#} Photos"}}],GUESTPASS_HISTORY:["Sharing history"],POSITION_IMAGE:["Position your image"],MIN_ZOOM:["You can't zoom out anymore for this image"],GIFT_PRO:["Gift Pro"],GIVE_PRO:["Give Pro"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-settings-notifications",function(o,e){o.Intl.add("hermes/settings-notifications","en-US",{COMMENT_OWN_PHOTOS:["Comments on your photos"],COMMENT_OTHER_PHOTOS:["Comments on photos you’ve commented on"],MESSAGES_FLICKRMAIL:["Messages (FlickrMail)"],EMAILS_HEADER:["Emails we send you"],PHOTO_ACTIVITY:["Activity on you or your photos"],GROUP_INVITATIONS:["Group invitations"],NEW_FOLLOWERS:["New followers"],PEOPLE_ONLY:["Only People I follow, please"],RECENT_UPLOADS:["Recent uploads from people you follow"],FRIENDS_AND_FAMILY_ONLY:["Only Friends & family, please"],IMMEDIATELY:["Immediately"],ONCE_PER_DAY:["Once per day"],ONCE_PER_WEEK:["Once per week"],GROUP_NOTIFICATIONS:["Group notifications"],GROUPS_NOTIFICATION_SUBTEXT:["We’ll notify you about new discussions, admin blasts, changes to rules, and descriptions, and status of your pending photos"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-basic-banner",function(e,a){var n=e.Template.Handlebars.revive({1:function(e,a,n,t,s){return'\t\t\t<a role="button" class="button dismiss">\n\t\t\t\t<svg class="icon icon-close"><use xlink:href="#icon-close"></use></svg>\n\t\t\t</a>\n'},compiler:[7,">= 4.0.0"],main:function(e,a,n,t,s){var r,i,l=null!=a?a:{},d=n.helperMissing,c=e.escapeExpression;return'<div class="basic-banner '+c("function"==typeof(i=null!=(i=n.additionalClasses||(null!=a?a.additionalClasses:a))?i:d)?i.call(l,{name:"additionalClasses",hash:{},data:s}):i)+'">\n\t<div class="banner-content fluid-centered">\n\t\t<div class="message-container">\n\t\t\t'+c((n.renderTrustedMarkup||a&&a.renderTrustedMarkup||d).call(l,null!=a?a.message:a,{name:"renderTrustedMarkup",hash:{},data:s}))+'\n\t\t</div>\n\t\t<div class="button-container">\n'+(null!=(r=n.if.call(l,null!=a?a.hideDismiss:a,{name:"if",hash:{},fn:e.noop,inverse:e.program(1,s,0),data:s}))?r:"")+"\t\t</div>\n\t</div>\n</div>\n"},useData:!0}),t={};e.Array.each([],function(a){var n=e.Template.get("hermes/"+a);n&&(t[a]=n)}),e.Template.register("hermes/basic-banner",function(a,s){return s=s||{},s.partials=s.partials?e.merge(t,s.partials):t,n(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("notification-banner-view",function(e,i){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.params=e,this.bannerTypes={notif_center:{title:"featured-banner.NOTIFICATION_CENTER_HEADER_BANNER",cookieName:"dismiss_notification_center_banner_name"},notif_drop:{title:"featured-banner.NOTIFICATION_UPDATED_BANNER",cookieName:"dismiss_notification_updated_banner_name"},notif_settings:{title:"featured-banner.NOTIFICATION_SETTINGS_HEADER_BANNER",cookieName:"dismiss_notification_settings_banner_name"}}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e,i=this.bannerTypes[this.params.bannerType].title;return e=this.intlHTMLMessage({intlName:i,learnUrl:"",feedbackUrl:""}),this.setContainerWithTemplate("basic-banner",{message:"<p>"+e+"</p>",additionalClasses:"head-banner-style"}),this},activate:function(){return this.registerEventHandler(this.get("container").one(".button.dismiss").on("click",this.dismissBanner.bind(this))),this},dismissBanner:function(){var i=this.bannerTypes[this.params.bannerType].cookieName,n=new Date;n.setTime(n.getTime()+2592e6),this.appContext.setCookie({cookieName:e.config.flickr.banners[i],cookieValue:1,expires:n,path:"/"}),this.get("container").remove(),this.destroy()}})},"@VERSION@",{requires:["flickr-view","hermes-template-basic-banner"],langBundles:["featured-banner"]});YUI.add("hermes-lang-featured-banner",function(a,e){a.Intl.add("hermes/featured-banner","en-US",{CHANGES_ARE_COMING:["Changes are coming to the way you log into Flickr!"],UPDATE_YOUR_EMAIL:["Update your email address to get started"],UPDATE_YOUR_LOGIN:["Update your login now"],WE_HAD_TROUBLE_PAYMENT:["We had trouble processing your credit card."],PLEASE_UPDATE_PAYMENT_PAST_DUE:["Please update your payment method to avoid losing Pro."],EXPLORE_IMPROVED:['Explore has been improved. <a href="',"${learnUrl}",'" target="_blank" class="learn-link">Learn more about the changes</a> and <a href="',"${feedbackUrl}",'" target="_blank" class="feedback-link">share your feedback</a>.'],COVID_19_HEADER_BANNER:['Staying inspired during the COVID-19 pandemic: <a href="',"${groups}",'" target="_blank" class="groups-link">Groups for inspiration</a> and <a href="',"${financial}",'" target="_blank" class="financial-assistance-link"> financial assistance options for photographers</a>.'],FEED_HEADER_BANNER:['Welcome to your new activity feed! Visit the blog to <a href="',"${learnUrl}",'" target="_blank" class="learn-link">learn what\'s new</a> then <a href="',"${feedbackUrl}",'" target="_blank" class="feedback-link">share your feedback</a>.'],NOTIFICATION_CENTER_HEADER_BANNER:['Welcome to your new Notification Center! <a href="',"${learnUrl}",'" target="_blank" class="learn-link">Learn more</a> and <a href="',"${feedbackUrl}",'" target="_blank" class="feedback-link">let us know what you think</a>.'],NOTIFICATION_UPDATED_BANNER:['Notifications have been updated! <a href="',"${learnUrl}",'" target="_blank" class="learn-link">Learn more</a> and <a href="',"${feedbackUrl}",'" target="_blank" class="feedback-link">let us know what you think</a>.'],NOTIFICATION_SETTINGS_HEADER_BANNER:['Welcome to your new Notification settings! <a href="',"${learnUrl}",'" target="_blank" class="learn-link">Learn more</a> and <a href="',"${feedbackUrl}",'" target="_blank" class="feedback-link">let us know what you think</a>.']})},"@VERSION@",{requires:["intl"]});YUI.add("notifications-panel-view",function(i,t){var n=require("hermes-core/flog")(t);i.namespace("Views")[this.name]=i.Base.create("notifications-panel-view",i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.params=t,this.notificationsHelper=new i.NotificationsHelper(this.appContext),this.selectedTabId="main",this.unreadCounts={main:void 0,admin:void 0}},subviewConfig:{"notifications-list-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"notification-banner-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,bannerType:"notif_drop"}},loadState:function(){var i=this;return this.appContext.getModel("person-notifications-models",this.appContext.getViewer().nsid).then(function(t){var n=t.getValue("unseenNotificationCounts");i.notificationsModel=t,i.unreadCounts={main:n.default||0,admin:n.groupsYouAdmin||0},i.unreadCounts.main=i.unreadCounts.main>=100?"99+":i.unreadCounts.main,i.unreadCounts.admin=i.unreadCounts.admin>=100?"99+":i.unreadCounts.admin})},buildContainer:function(){var t=!parseInt(this.appContext.getCookie(i.config.flickr.banners.dismiss_notification_updated_banner_name))&&this.appContext.flipper.isFlipped("enable-notification-banners");this.setContainerWithTemplate("notifications-panel",{width:this.params.width,height:this.params.height,unreadCounts:this.unreadCounts,showBanner:t})},activate:function(){var t=this,n=this.get("container");return this.tabNodes={},this.listView=this.subviews["notifications-list-view"],this.tabContainer=n.one(".tabs"),this.tabNodes.main=this.tabContainer.one('.tab[data-tab-id="main"'),this.tabNodes.admin=this.tabContainer.one('.tab[data-tab-id="admin"'),this.scrollContainer=n.one(".list-container"),this.scrollContainer&&(this.scrollContainerHeight=this.scrollContainer.get("clientHeight"),this.registerEventHandler(this.scrollContainer.on("scroll",i.betterThrottle(this.handleScroll.bind(this),100,this,!1)))),this.registerEventHandler(this.tabContainer.delegate("click",this.handleTabClick.bind(this),".tab")),this.registerEventHandler(n.on("click",this.handleAnalyticsClicks.bind(this))),this.listView.setAdditionalApiParams(this.notificationsHelper.getFilterConfig("all").additionalApiParams),this.listView.isActivated?this.loadInitial():this.listView.on("activated",function(){t.loadInitial()}),this.registerEventHandler(this.appContext.flapp.before("navigate",function(i){var t=i.details[0].url,n=this.notificationsModel.getValue("unseenNotificationCounts");t&&(t.match(/^.+(\/notifications)$/)?this.notificationsModel.setValue("unseenNotificationCounts",Object.assign(n,{total:0})):this.notificationsModel.setValue("unseenNotificationCounts",{}))}.bind(this))),this},loadInitial:function(){var i=this;return this.listView.loadInitial().then(function(t){return i.tabContainer.removeClass("disabled"),i.listView.appendItems(t)})},handleTabClick:function(i){var t=i.target.ancestor(".tab",!0).getAttribute("data-tab-id");this.switchTabs(t)},switchTabs:function(i){i&&this.tabNodes[i]&&i!==this.selectedTabId&&(this.selectedTabId=i,Object.values(this.tabNodes).forEach(function(i){i.removeClass("selected")}),this.tabNodes[i].addClass("selected"),this.loadTab(i))},loadTab:function(i){var t=this;return this.tabContainer.addClass("disabled"),"main"===i?this.listView.setAdditionalApiParams(this.notificationsHelper.getFilterConfig("all").additionalApiParams):"admin"===i&&this.listView.setAdditionalApiParams(this.notificationsHelper.getFilterConfig("groupsYouAdmin-all").additionalApiParams),this.listView.reload().then(function(){t.tabContainer.removeClass("disabled")}).catch(function(i){n.error("error reloading notification listing",i)})},handleScroll:function(i){var t=this,n=this.scrollContainer.get("scrollTop"),a=this.scrollContainer.get("scrollHeight");!this.listView.isLoadingMore&&n+this.scrollContainerHeight+100>a&&!this.listView.isAtEnd&&(t.tabContainer.addClass("disabled"),this.listView.loadContinuated().then(function(i){return t.tabContainer.removeClass("disabled"),t.listView.appendItems(i)}))},handleAnalyticsClicks:function(i){var t=i.target;t.ancestor('.tab[data-tab-id="main"]',!0)?this.beaconAnalytics("Tab Click: main"):t.ancestor('.tab[data-tab-id="admin"]',!0)?this.beaconAnalytics("Tab Click: admin"):t.ancestor(".foot-link",!0)&&this.beaconAnalytics("View All Click")},beaconAnalytics:function(t){i.Analytics.setDataLayerProp("notifications.actionType",t),i.Analytics.setDataLayerProp("notifications.location","panel"),i.Analytics.sendClick("","Notifications Feature Action"),i.Analytics.setDataLayerProp("notifications.actionType",""),i.Analytics.setDataLayerProp("notifications.location","")}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-panel","notifications-helper","notification-banner-view"],langBundles:["common","notifications","relative-dates"]});YUI.add("notifications-menu-view",function(t){"use strict";t.namespace("Views")[this.name]=t.Base.create("notifications-menu-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.pollingFailed=!1,this.shouldFetchNotifs=!0,this.notifFilter=this.appContext.flipper.isFlipped("enable-notifications-2020")?[]:["group_topic_new","user_gallery_comment"].join(","),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("notifications-menu"),this},loadState:function(){var e=this,i=this.appContext.getViewer();return this.appContext.getModel("person-notifications-models",i.nsid).then(function(n){if(e.set("personNotificationsModel",n),Date.now()-n.getValue("unseenLastFetchedTimestamp")>t.config.flickr.notifications.loading_count_refetch_delay)return n.remoteReadUnseenNotificationCount({id:i.nsid,filter:e.notifFilter},e.appContext).then(null,function(t){e.pollingFailed=!0})})},buildContainer:function(){var t=this.formatCount99(this.get("personNotificationsModel").getValue("unseenNotificationCount"));return this.setContainerWithTemplate("notifications-menu",{unseenNotificationCount:t}),this},activate:function(){var e,i=this,n=i.get("personNotificationsModel");i.unseenBadge=i.get("container").one(".c-notification-unseencount"),i.unseenCount=0,i.notifIcon=i.get("container").one(".c-notification-icon"),this.appContext.flipper.isFlipped("enable-notifications-2020")?(e=n.getValue("unseenNotificationCounts")||{}).total>0?(i.unseenBadge.set("text",i.formatCount99(e.total)),i.unseenBadge.removeClass("hidden")):i.unseenBadge.addClass("hidden"):0===n.getValue("unseenNotificationCount")?i.unseenBadge.addClass("hidden"):i.unseenBadge.removeClass("hidden"),t.on("notifications:closeNotificationsMenuClicked",function(t){i.droparound.close()}),this.registerEventHandler(this.get("container").on("click",i.openMenu.bind(i))),this.registerEventHandler(this.get("container").on("key",i.keyboardToggleMenu.bind(i),"down:13,32")),this.registerEventHandler(this.get("container").on("key",i.enterMenu.bind(i),"down:9,40")),i.pollForUnseenNotifs()},pollForUnseenNotifs:function(){this.pollIntervalId=setInterval(this.readUnseenNotifs.bind(this),t.config.flickr.notifications.polling_delay)},readUnseenNotifs:function(){var e=this,i=this.appContext.getViewer(),n=e.get("personNotificationsModel");n.remoteReadUnseenNotificationCount({id:i.nsid,filter:e.notifFilter},e.appContext).then(function(t){var i;e.shouldFetchNotifs=!0,n.setValue("initialNotificationsData",{}),e.appContext.flipper.isFlipped("enable-notifications-2020")?(i=n.getValue("unseenNotificationCounts")||{}).total>0?(e.unseenBadge.set("text",e.formatCount99(i.total)),e.unseenBadge.removeClass("hidden")):e.unseenBadge.addClass("hidden"):t!==e.unseenCount&&(e.unseenCount=t,0!==t?(e.unseenBadge.removeClass("hidden"),e.unseenBadge.set("text",e.formatCount99(t))):e.unseenBadge.addClass("hidden"))},function(i){clearInterval(e.pollIntervalId),e.pollingFailed||(e.pollingFailedTimeoutId=setTimeout(e.pollForUnseenNotifs.bind(e),t.config.flickr.notifications.polling_failure_timeout)),e.pollingFailed=!0})},openMenu:function(){this.revealNotifications()},keyboardToggleMenu:function(t){t.preventDefault(),!this.droparound||this.droparound.isClosed?this.revealNotifications():this.droparound.close()},enterMenu:function(t){var e=t.keyCode;if(9===e&&!t.shiftKey&&"true"===t.target.getAttribute("aria-expanded")||40===e){t.preventDefault();var i=this.droparound.get("container").one("div.notifs-droparound");if(i){var n=i.one("a.mail-icon");this.registerEventHandler(n.on("key",this.enterNotificationsList.bind(this),"down:9,40")),n.focus()}}},enterNotificationsList:function(t){var e=t.keyCode;(9===e&&!t.shiftKey||40===e)&&(t.preventDefault(),this.droparound.get("subview").findFocus.call(this,this.droparound.get("container").one("div.notifs-droparound").one("ul").one("li:not(.hidden)")))},revealNotifications:function(){var e,i=this.appContext.viewportData.getWidth(),n=this.appContext.viewportData.getHeight(),o=i>700?60:67,s=i>700?"":i-2+"px",a=n>1e3?"800px":n-200+"px";if(this.appContext.flipper.isFlipped("enable-notifications-2020")){var r=this.get("container").one(".c-notification-icon"),l=r.get("clientWidth"),d=i-r.get("offsetLeft")-l,c=i>700?450:i-2,u=Math.min(n-100,800);t.Analytics.sendClick("Notifications Bell: 2020"),d=i>700?Math.min(d,60):d,e=new t.Views["notifications-panel-view"]({appContext:this.appContext,width:c,height:u}),this.droparound=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,anchorOffsetHorizontal:d-1,mirrorArrowAdjustment:d-1-l/2,showDropArrow:!0,contentPadding:0,anchorElement:r,subview:e,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden");var f=this.get("personNotificationsModel"),p=f.getValue("unseenNotificationCounts");f.setValue("unseenNotificationCounts",Object.assign(p,{total:0})),this.shouldFetchNotifs=!1}else t.Analytics.sendClick("Notifications Bell: Legacy"),(e=new t.Views["notifications-view"]({appContext:this.appContext,width:s,listHeight:a,shouldFetchNotifs:this.shouldFetchNotifs,notifFilter:this.notifFilter})).appContext=this.appContext,this.droparound=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,anchorOffsetHorizontal:o,mirrorArrowAdjustment:o-11,showDropArrow:!0,contentPadding:0,classList:"notifs-droparound no-border big-shadow",anchorElement:this.get("container").one(".c-notification-icon"),subview:e,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden"),this.shouldFetchNotifs=!1},formatCount99:function(t){return t>=100?"99+":t},destructor:function(){clearInterval(this.pollIntervalId),clearTimeout(this.pollingFailedTimeoutId)}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-menu","fluid-droparound-view","notifications-view","notifications-panel-view"],langBundles:["notifications","common"]});